#!/usr/bin/env bash

# Yank org link
# If it's a github repo root, get the package name only

url_root="$(echo $QUTE_URL | awk -F '/' '{print $3}')"

# Should be at root of the repo
# Checked by counting number of dashes
num_dashes=$(echo "$QUTE_URL" | grep -o "/" | wc -l)

if [[ "$url_root" == "github.com" && $num_dashes == 4 ]]; then
    title=$(echo "$QUTE_TITLE" | awk -F : '{ print $1}')
else
    title="$QUTE_TITLE"
fi

echo -n "[[$QUTE_URL][$title]]" | xclip -selection c
echo "message-info 'url turned to org url'" >> "$QUTE_FIFO"
