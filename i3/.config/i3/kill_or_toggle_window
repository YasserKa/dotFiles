#!/usr/bin/env bash
# close window or hide it if it's zotero
#
# dependencies: i3/sway jq

is_zotero_main_window="$(i3-msg -t get_tree |
	jq --arg re "- Zotero$" '
  any(
    recurse(.nodes[]?, .floating_nodes[]?);
    .focused and (
      ((.name // "") | test($re)) or
      ((.app_id // "") | test($re)) or
      ((.window_properties.class // "") | test($re))
    )
  )
  ')"
if [[ "$is_zotero_main_window" == "true" ]]; then
	i3-msg '[title="Zotero$"]' move scratchpad
else
	i3-msg 'kill'
fi
