# vim: filetype=sh

# function go_to_app() {

# }

# function bring_app() {

# }

# function is_window_exist() {

# }


function open_cli() {
    local command="$1"

    [[ ! $(command -v $command) ]] && notify-send "$command doesn't exit"

    [[ $TERMINAL != "kitty" ]] && notify-send "$TERMINAL is not supported" && return

    # Check if it's in a terminal
    tty -s && $command || $TERMINAL -- $command
}

cli_list=("neomutt" "tuir" "newsboat")

for cli in "${cli_list[@]}"; do
  alias $cli="open_cli $cli"
done
unset cli

alias neomutt="open_cli neomutt"

function open_gui() {
    local name="$1"
    local command="$2"

    xdotool search --name $name windowactivate
    if [[ $? != 0 ]]; then
        bash -c "chronic ${command} & disown"

        # Wait until window is visible
        xdotool search --sync --name "^$name$" windowactivate
    fi
}

function org() {
    local name="emacs_org_name"

    open_gui $name "emacs --title=$name --file=$NOTES_ORG_HOME/general.org"
}

function magit() {
    local name="magit_name"
    local git_root=$(git rev-parse --show-toplevel)

    chronic git rev-parse --show-toplevel || return 1
    open_gui $name \
        "emacs --title=$name --eval '(magit-status \"${git_root}\")'"
}
