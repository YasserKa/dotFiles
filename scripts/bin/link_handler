#!/usr/bin/env bash

# A new protocol to handle links that executes commands
# decoded example: link-handler://zathura /home/yasser/books/programming_languages/bash/bash.pdf --page=44

scheme='link-handler://'
url="$1"

urldecode() {
    local url_encoded="${1//+/ }"
    printf '%b' "${url_encoded//%/\\x}"
}

decoded_url="$(urldecode ${@})"

bash -ic "${decoded_url#*${scheme}}"
